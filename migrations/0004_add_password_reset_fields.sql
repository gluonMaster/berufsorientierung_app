-- ============================================================================
-- Migration: Add Password Reset Fields
-- Database: Cloudflare D1 (SQLite)
-- Version: 0004
-- Created: 2025-11-19
-- Description: Добавление полей для хранения токена сброса пароля
-- ============================================================================

-- Добавляем поля для токена сброса пароля
-- password_reset_token_hash: хеш токена сброса пароля (SHA-256 в hex-формате, 64 символа)
-- password_reset_expires_at: время истечения токена в формате ISO-8601 (YYYY-MM-DDTHH:MM:SS)
ALTER TABLE users ADD COLUMN password_reset_token_hash TEXT;
ALTER TABLE users ADD COLUMN password_reset_expires_at TEXT;

-- Комментарий для будущих разработчиков:
-- - Токен должен быть захеширован через SHA-256 перед сохранением (hex-строка, 64 символа)
-- - Время истечения обычно устанавливается на 1 час с момента запроса
-- - После успешного сброса пароля или истечения срока, оба поля должны быть очищены (NULL)
-- - Формат expires_at: YYYY-MM-DDTHH:MM:SS (без миллисекунд и часового пояса)

-- ============================================================================
-- END OF MIGRATION
-- ============================================================================
